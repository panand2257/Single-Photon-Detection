import numpy as np
import matplotlib.pyplot as plt

plt.rcParams['text.usetex'] = True
plt.rcParams.update({'font.size': 14})


t_s = np.linspace(-3, 3, 100)

#nu = np.array([0.41779714860730566, 0.4487618928489089, 0.48049790256459496, 0.5133688143468594, 0.5472132192924253, 0.5824023710359637, 0.6175531750740408, 0.6529374747819285, 0.6882191708021256, 0.7235806083994095, 0.7574497735465346, 0.789937330802141, 0.8205463642039467, 0.848757288606308, 0.8744270969155282, 0.8961947009858736, 0.9139952593276293, 0.9273643484005224, 0.935994469804387, 0.9392767345461678, 0.9371618377172782, 0.9295314049202937, 0.9163884401241585, 0.897515473785524, 0.8737820199845716, 0.8458076971373376, 0.8131374564597336, 0.7761489996115019, 0.7366848756996759, 0.6948607950901277, 0.6513776861825642, 0.6069289038233426, 0.5614450163592681, 0.517014963945751, 0.4734539989482794, 0.43123519882899575, 0.3901032420142753, 0.35169791507049736, 0.31556801499291937, 0.2818653198199089, 0.2506731110794551, 0.22156592330333127, 0.19545457759439655, 0.17177953761868867, 0.1504393493267678, 0.13101278992470797, 0.1139829304837918, 0.09886718560895813, 0.0855096785612277, 0.0735743485711064])
#nu = np.array([0.41779714860730566, 0.4331100454608671, 0.44825183204464647, 0.4636992585434066, 0.47996810151213354, 0.495992541546433, 0.512274659114776, 0.5293487626756114, 0.5460901123043185, 0.5630206322605396, 0.5806849694607552, 0.597912490836277, 0.6152376530592547, 0.6326249377039954, 0.6506164359877755, 0.6680092841942095, 0.6853399805535474, 0.7031338131159467, 0.7201924588677869, 0.7370405326260738, 0.7541718248691119, 0.7704235344377134, 0.7862950451498898, 0.8017266863342283, 0.8171457081123937, 0.8314933964675392, 0.8452129138304785, 0.858662615290574, 0.8709098574731511, 0.8823378381493635, 0.8932207810088099, 0.9027950479400538, 0.911369096173894, 0.9191198476060111, 0.9254942326438921, 0.9307125191709769, 0.9347314638459544, 0.9375837670112895, 0.9390517482436714, 0.9392215411882223, 0.9380116126311456, 0.9354861317003839, 0.9316217834985849, 0.9262230988368608, 0.9196470699928724, 0.9117578874464642, 0.9025790959188885, 0.891772438512475, 0.8800743881274186, 0.8672023142380982, 0.85320792691664, 0.8381490008880048, 0.8220888573048742, 0.8045141156656072, 0.7866333421122385, 0.7679711147305571, 0.7486067240484184, 0.7279457499575399, 0.7074064099445211, 0.6864157124553494, 0.6643399418085346, 0.6426884999305577, 0.6208363117942749, 0.5981291216133382, 0.576110794629659, 0.55412397894578, 0.5322386951388446, 0.5098007263243274, 0.4883211720534049, 0.4671302411445699, 0.4455918898712315, 0.4251446448391358, 0.4051304239487012, 0.38494411612568424, 0.36592192421895053, 0.3474327717863721, 0.3289123110596461, 0.3115750571130178, 0.29482902379718534, 0.2786850992699048, 0.2626431777490694, 0.24774197947419752, 0.2334542518940714, 0.2193320747744978, 0.20628123267591073, 0.1938284289105918, 0.1815785042999958, 0.17030990327141776, 0.15960455671565343, 0.1494479426108566, 0.13951261013445468, 0.13042248859697642, 0.12183095591948088, 0.11345782668756527, 0.10582450667295425, 0.09863446241580101, 0.09165064236979542, 0.08530447527172083, 0.07934521170524196, 0.0735743485711064])

nu = [[0.41733791893470235, 0.4326382818784013, 0.44776785643980194, 0.46320300726613695, 0.47945911807655145, 0.4954712111597062, 0.5117409777866205, 0.5288023378896998, 0.5455313976791921, 0.5624496943541246, 0.580101498064008, 0.5973170118262225, 0.6146303142281946, 0.6320059156922967, 0.6499855586968277, 0.6673671759854523, 0.6846869113082499, 0.702469735227889, 0.7195180687192002, 0.736356199514716, 0.7534776410117262, 0.7697202622249036, 0.7855831559613324, 0.8010066850062614, 0.8164178897074051, 0.8307585937053802, 0.8444717297012838, 0.8579155029827683, 0.8701576827050818, 0.881581292383511, 0.8924604725535918, 0.90203185249637, 0.9106037777086935, 0.9183531584591565, 0.9247270307099089, 0.9299456187630015, 0.9339656900533616, 0.9368200322674044, 0.9382908377940459, 0.9384642929370832, 0.9372590259690764, 0.9347388987594999, 0.930880722849443, 0.9254892616882676, 0.9189210238019688, 0.9110403985776793, 0.9018709065573466, 0.8910746092192502, 0.8793872796950134, 0.866526576479798, 0.8525441735457363, 0.837497807092426, 0.8214507576560984, 0.8038900631786723, 0.7860233382654883, 0.7673755609696505, 0.7480259757078096, 0.7273806242597826, 0.7068566679726871, 0.6858815675459038, 0.6638220886337542, 0.6421865350626721, 0.6203503100447078, 0.5976596474074505, 0.5756573028524552, 0.5536864169538228, 0.5318169717610494, 0.5093952349549489, 0.48793122357358704, 0.466755640358723, 0.4452329117930712, 0.42480052855105727, 0.40480089166850947, 0.38462933845862346, 0.36562109946648247, 0.34714556195131263, 0.3286387989276408, 0.31131442868769726, 0.2945809024471873, 0.2784491000299284, 0.26241929357261157, 0.2475294172040998, 0.23325261319492857, 0.21914130438057433, 0.20610057488037992, 0.19365748742090472, 0.18141719036881326, 0.17015751183165026, 0.1594607055530143, 0.1493122562209705, 0.13938497420893592, 0.13030227795790067, 0.12171782007965755, 0.11335164329792861, 0.10572471499303362, 0.09854074183244803, 0.09156286957828845, 0.08522215422487954, 0.07926805413623564, 0.073502235306078], [0.41323544556809394, 0.4284236373914506, 0.4434439139608494, 0.4587691896826418, 0.4749113319579532, 0.4908128966133396, 0.5069720910756872, 0.5239193573404306, 0.5405383766055349, 0.5573472211032161, 0.5748867861663621, 0.5919947625500224, 0.6092018427630416, 0.6264727961538681, 0.6443462406333983, 0.6616272436942525, 0.6788487738246951, 0.6965329567808279, 0.7134888799077671, 0.7302379004579098, 0.7472710479288833, 0.7634321983297911, 0.7792178363546671, 0.7945686247620299, 0.8099097222289554, 0.8241877743965639, 0.8378436537990329, 0.8512342208367382, 0.8634309470212777, 0.8748152921280836, 0.8856606482292328, 0.8952060480253432, 0.9037588327697503, 0.9114958046677902, 0.9178649541132009, 0.9230861112233147, 0.9271161404636417, 0.929988607658668, 0.9314845754444837, 0.9316906975040411, 0.9305270444816768, 0.9280547351643347, 0.9242517095260322, 0.9189248104298395, 0.9124262225944191, 0.9046221127116748, 0.8955357850173966, 0.8848321483780222, 0.8732407167260706, 0.8604817328265624, 0.8466065473254348, 0.8316725515999681, 0.8157426623465726, 0.7983076608678691, 0.7805666473172278, 0.7620481779598371, 0.7428310840104084, 0.7223255403282184, 0.7019392562366241, 0.6811037390926212, 0.6591900619267081, 0.6376967005062598, 0.6160033376374855, 0.5934605885810587, 0.5716012786048982, 0.5497729554421981, 0.5280452559241958, 0.5057687839521364, 0.4844438685017309, 0.46340563233609944, 0.44202270952446027, 0.42172332023398523, 0.4018541886857862, 0.3818146645100039, 0.362931277675569, 0.34457756466401435, 0.3261933634834212, 0.3089842683268154, 0.29236264391598926, 0.27633929554866393, 0.2604178764063666, 0.24562928780383586, 0.23145020443334566, 0.21743611819187678, 0.20448584751876492, 0.19212967052406127, 0.17997548653322248, 0.16879561122667439, 0.1581751863440192, 0.14809975680279197, 0.13824446899217518, 0.12922817293929806, 0.12070697808253476, 0.11240296724927669, 0.10483318814530056, 0.09770349484356669, 0.09077879729368672, 0.08448681932208028, 0.07857887718439216, 0.07285814855002914], [0.375061200304996, 0.3891875901110196, 0.4031725857280585, 0.41745644176112107, 0.43251765082958854, 0.4473702095241018, 0.46247928700705904, 0.47834225025641125, 0.4939147648314321, 0.5096819803198636, 0.5261526345510997, 0.5422357247177813, 0.5584297090678875, 0.5747018249977597, 0.5915608296340906, 0.607879945033457, 0.6241618254366339, 0.6409013393392843, 0.6569714195662198, 0.6728653786411022, 0.6890503704713029, 0.7044279774726945, 0.7194696518469457, 0.734118946591821, 0.7487828198537118, 0.7624544950483014, 0.7755549644760397, 0.7884279658651533, 0.8001809743951201, 0.8111802569840987, 0.8216917393141238, 0.8309781466648147, 0.8393369251013914, 0.8469434954546453, 0.8532557697779201, 0.858489472148366, 0.8626024299456145, 0.8656352624935092, 0.8673590984259358, 0.8678646776395454, 0.8670854545897735, 0.865057216195546, 0.8617682841314689, 0.8570449615398527, 0.8511989969039334, 0.8441131251480211, 0.8358085963408446, 0.8259771100182957, 0.815289234114222, 0.8034894811791955, 0.790626114475053, 0.7767532306662864, 0.7619302677454318, 0.7456833557126468, 0.7291310664241186, 0.7118357222947135, 0.6938721995189393, 0.6746897447090768, 0.6556065692577038, 0.6360924259787992, 0.615559125130118, 0.5954120516041764, 0.5750713616179771, 0.5539291159631253, 0.5334240767976904, 0.5129454862986496, 0.4925596809839512, 0.4716582792454887, 0.4516498765749817, 0.43191141491009316, 0.41185131568815847, 0.3928100651359689, 0.3741752829633196, 0.35538424371029415, 0.33768119510330125, 0.3204789089772993, 0.30325279062777327, 0.2871326150333094, 0.27156773353795677, 0.2565682526336996, 0.241669735775095, 0.22783672181171483, 0.214579239293196, 0.20148172137960726, 0.18938393154264926, 0.1778464822682535, 0.16650318966827723, 0.1560744798509395, 0.14617271384955485, 0.13678402318105123, 0.12760553045124456, 0.11921316106714497, 0.11128614616655425, 0.103565738391524, 0.09653221057513871, 0.089911602017676, 0.08348537892007853, 0.07765005055737473, 0.0721743743809309, 0.06687569558910397], [0.16525211040967897, 0.17277183544127356, 0.18028254720868186, 0.18802105913402753, 0.1962536735838365, 0.20444500565244603, 0.21285150808079684, 0.2217571276843056, 0.23057891886265874, 0.23959103304718254, 0.2490914845697237, 0.25845397541944604, 0.2679672715561761, 0.27761475794857116, 0.2877051322017529, 0.2975663622036113, 0.3074996606353303, 0.3178137805532757, 0.3278160686251661, 0.33781010342917234, 0.34809626510067004, 0.3579776977989426, 0.3677529053630121, 0.3773860860961749, 0.3871515114065859, 0.39637938856018495, 0.405348109061419, 0.41430025451428765, 0.42261573934937785, 0.43054687813332315, 0.43829430801612407, 0.4453156808771416, 0.45182763496064987, 0.4579795183707277, 0.46333539535121854, 0.46806707062167513, 0.47214085894587265, 0.47562644932309556, 0.4782704308474435, 0.4801727079340145, 0.4813376354950827, 0.4816735234208459, 0.4812191973429579, 0.47991229130783425, 0.4778351091096498, 0.47496188962151026, 0.4713007329774879, 0.4667037271113675, 0.4614860673485871, 0.4555352523963719, 0.44887882414120117, 0.4415486330691827, 0.4335805181383098, 0.42471856703888683, 0.4155784244452231, 0.4059294554930596, 0.3958194294498569, 0.3849406699166816, 0.3740472712187348, 0.36284644317468334, 0.35100432491028055, 0.3393379343784995, 0.3275200664059451, 0.3152019126733991, 0.30322766617331437, 0.2912475651151277, 0.2793055821050056, 0.2670496234476506, 0.2553102142263564, 0.24372624205187898, 0.2319542427267646, 0.2207841827104299, 0.2098594682366527, 0.19885310969169362, 0.188495952327949, 0.1784454623149261, 0.16839717294134263, 0.15901101216848437, 0.14996604312496145, 0.14126838217414112, 0.13264965747586133, 0.12466753845861908, 0.11703770187431412, 0.10952125056522008, 0.10259914804100494, 0.09601780125918323, 0.08956808063478365, 0.08365822559525701, 0.07806606328330798, 0.0727822399011566, 0.06763561483972763, 0.06294746205540094, 0.05853600269177382, 0.05425638175694278, 0.05037312936178353, 0.046732507931016964, 0.043213417312305005, 0.04003136025533554, 0.03705795763153649, 0.03419309897397016], [0.005239940708181825, 0.0056687595920686526, 0.006113394070962326, 0.006588742725896188, 0.007113847965328693, 0.007656426530230143, 0.008234411899931, 0.008870472430548575, 0.009525091274085809, 0.01021958207126087, 0.010980535894347228, 0.011760136137590168, 0.012583352901352056, 0.013451155565580462, 0.014395566176483012, 0.015356256371952464, 0.016363275580965123, 0.01745261223028339, 0.018553750548081227, 0.01970048750481182, 0.020932352856969406, 0.0221684878185098, 0.02344610672118226, 0.024762961983472463, 0.026162022060069352, 0.027549679220372533, 0.02896668181889748, 0.030457139804507802, 0.031919870338295776, 0.03339712299238127, 0.034932524527875604, 0.036420341340330765, 0.03790301294067475, 0.03942181034307933, 0.040870705777287145, 0.042290792062707284, 0.04367365857594531, 0.04505439994230384, 0.04633502617229178, 0.04755224190330643, 0.048734359207469685, 0.04979659007576547, 0.05077037643039136, 0.051675763234728396, 0.05244723962786663, 0.05310943065155682, 0.05365688329780672, 0.0540971703495298, 0.05439813389669758, 0.05457334877189542, 0.05462121135045041, 0.054541183656711636, 0.054333803794708216, 0.05398743681296635, 0.05352717090410467, 0.052947600343348986, 0.05225335099288726, 0.05142132700900635, 0.05051167291536047, 0.04950632040205569, 0.048374961824118975, 0.04719885756450821, 0.04595134142491216, 0.044596407836932944, 0.04323049857114681, 0.04181970389050552, 0.040372747235265787, 0.03884864839386324, 0.03735425474163112, 0.03584875882229537, 0.0342894294510105, 0.03278415366040171, 0.031289229333523086, 0.02976177621390742, 0.028305990278670937, 0.026877217817072186, 0.02543382814636877, 0.024072844401609363, 0.022750398499152523, 0.02146920274925929, 0.020190977147332593, 0.018999959358646467, 0.017855450296526156, 0.016722557711686414, 0.015674856675439965, 0.014675131866903493, 0.013692285294231296, 0.012789250200832648, 0.011932820417374698, 0.011122081856019164, 0.010331159857924054, 0.009609806088946442, 0.008930407001108564, 0.008270886190270896, 0.007672216947252585, 0.00711087148386964, 0.006568303253186612, 0.006077832010000462, 0.005619728076769376, 0.005178623424843576]]

fig = plt.figure()
ax = fig.add_subplot()


# plt.plot(t_s, nu[0], '-', color = 'green', label = r'$\gamma_{e}/2\pi = 10^{2} Hz$')
# plt.plot(t_s, nu[1], '-', color = 'red', label = r'$\gamma_{e}/2\pi = 10^{3} Hz$')
# plt.plot(t_s, nu[2], '-', color = 'blue', label = r'$\gamma_{e}/2\pi = 10^{4} Hz$')
# plt.plot(t_s, nu[3], '-', color = 'gold', label = r'$\gamma_{e}/2\pi = 10^{5} Hz$')
# plt.plot(t_s, nu[4], '-', color = 'orange', label = r'$\gamma_{e}/2\pi = 10^{6} Hz$')
# plt.plot(t_s, 0.8*t_s/t_s, '--', color = 'black')

v_cut = np.array([0.8]) #np.linspace(0.5, 0.95, 100)
wind = []

for k in np.array([2]):
    w = []
    for cut in v_cut:

        max_nu = max(nu[k])
        res = []

        if (cut < max_nu):
            nu_pr = nu[k] - cut
            for j in np.arange(len(nu_pr)):
                if (nu_pr[j] > 0):
                    res.append(t_s[j])
            w.append( max(res) - min(res))
        
        else:
            w.append(0)


print(max(res))
print(min(res))
print( t_s[np.argmax(np.array(nu[2]))] )
print(max(nu[2]))
#         #print(max(res) - min(res))

        
#     wind.append(w)


# plt.plot(wind[0], v_cut, '-', color = 'green', label = r'$\gamma_{e}/2\pi = 10^{2} Hz$')
# plt.plot(wind[1], v_cut,  '-', color = 'red', label = r'$\gamma_{e}/2\pi = 10^{3} Hz$')
# plt.plot(wind[2], v_cut, '-', color = 'blue', label = r'$\gamma_{e}/2\pi = 10^{4} Hz$')
# #plt.plot(wind[3], v_cut, '-', color = 'gold', label = r'$\eta/n, \gamma_{e}/2\pi = 10^{5} Hz$')
# #plt.plot(wind[4], v_cut, '-', color = 'orange', label = r'$\eta/n, \gamma_{e}/2\pi = 10^{6} Hz$')

# # plt.plot(wind, v_cut, '-', color = 'red')

# plt.xlabel(r"$T_{window}$ (in units of $T_{c}$)")
# plt.ylabel(r"$\nu_{cutoff}$")
# #plt.xlabel(r"$\Delta t_{shift}/T_{c}$")
# #plt.ylabel(r"$\nu$")
# ax.set_aspect(1.0/ax.get_data_ratio(), adjustable='box')

# plt.legend()
# plt.show()
